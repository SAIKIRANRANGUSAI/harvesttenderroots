<%- include('partials/header') %>
   <main>


      <!-- breadcrumb-area-start -->
      <div class="it-breadcrumb-area it-breadcrumb-bg"
         style="background-image: url(/images/breadcrumb-img.png); background-size: cover; background-position: center center; background-repeat: no-repeat;">
         <div class="container">
            <div class="row ">
               <div class="col-md-12">
                  <div class="it-breadcrumb-content z-index-3 text-center">
                     <div class="it-breadcrumb-title-box">
                        <h3 class="it-breadcrumb-title"><%- eventDetail.event_name %></h3>
                     </div>
                     <div class="it-breadcrumb-list-wrap">
                        <div class="it-breadcrumb-list">
                           <span><a href="/">home</a></span>
                           <span class="dvdr">//</span>
                           <span>
                              <%= eventDetail.event_name.replace(/<[^>]*>/g, '') %>
                           </span>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </div>
      <!-- breadcrumb-area-end -->

      <!-- postbox area start -->
      <div class="postbox__area pt-120 pb-60">
         <div class="container">
            <div class="row">
               <div class="col-xxl-8 col-xl-8 col-lg-8">
                  <div class="postbox__details-wrapper">
                     <article>
                        <!-- Swiper slider for images -->
                        <div class="postbox__thumb mb-30 w-img">
                           <div class="swiper mySwiper">
                              <div class="swiper-wrapper">
                                 <% const images=[eventDetail.image1, eventDetail.image2, eventDetail.image3,
                                    eventDetail.image4, eventDetail.image5].filter(img=> img);
                                    if(images.length === 0) images.push('/images/default-event.png');
                                    images.forEach(img => {
                                    %>
                                    <div class="swiper-slide">
                                       <img src="<%= img %>" class="d-block w-100 img-fluid" alt="Event Image"
                                          style="border-radius:6px;">
                                    </div>
                                    <% }) %>
                              </div>
                              <div class="swiper-button-next"></div>
                              <div class="swiper-button-prev"></div>
                              <div class="swiper-pagination"></div>
                           </div>
                        </div>

                        <div class="postbox__details-title-box pb-40">
                           <div class="postbox__meta mb-2">
                              <% if(eventDetail.event_date) { %>
                                 <span><i class="fa-solid fa-calendar-days"></i>
                                    <%= new Date(eventDetail.event_date).toLocaleDateString('en-US', { day:'numeric',
                                       month:'long', year:'numeric' }) %>
                                 </span>
                                 <% } %>
                           </div>
                           <h4 class="postbox__title mb-10"><%- eventDetail.event_name %></h4>
                           <p><%- eventDetail.description %></p>
                        </div>
                     </article>
                  </div>
               </div>

               <!-- Sidebar recent posts -->
               <div class="col-xxl-4 col-xl-4 col-lg-4">
  <div class="it-sv-details-sidebar">
    <div class="sidebar__widget mb-55">
      <div class="sidebar__widge-title-box">
        <h3 class="sidebar__widget-title pb-10">Recent Post</h3>
      </div>
      <div class="sidebar__widget-content">
        <div class="sidebar__post">
          <% recentEvents
               .filter(ev => ev.event_name !== eventDetail.event_name) // exclude current event
               .forEach(ev => { 
                  const cleanName = ev.event_name.replace(/<[^>]*>/g, ''); // strip HTML
          %>
            <div class="rc__post mb-30 d-flex align-items-start">
              <div class="rc__post-thumb mr-20" style="flex-shrink:0; width:80px; height:80px; overflow:hidden; border-radius:6px;">
                <a href="/blog-view/<%= cleanName.toLowerCase().replace(/ /g, '-') %>">
                  <img src="<%= ev.image1 || '/images/default-event.png' %>" alt="<%= cleanName %>" style="width:100%; height:100%; object-fit:cover;">
                </a>
              </div>
              <div class="rc__post-content">
                <div class="rc__meta mb-1" style="font-size: 0.85rem; color:#888;">
                  <% if(ev.event_date) { %>
                    <span><i class="fa-solid fa-calendar-days"></i>
                      <%= new Date(ev.event_date).toLocaleDateString('en-US', { day:'numeric', month:'long', year:'numeric' }) %>
                    </span>
                  <% } %>
                </div>
                <h3 class="rc__post-title mb-1" style="font-size:1rem;">
                  <a href="/blog-view/<%= cleanName.toLowerCase().replace(/ /g, '-') %>"><%= cleanName %></a>
                </h3>
                <p style="font-size:0.85rem; margin:0;"><%- ev.description.substring(0, 80) %>...</p>
              </div>
            </div>
          <% }) %>
        </div>
      </div>
    </div>
  </div>
</div>


               <!-- Sidebar end -->

            </div>
         </div>
      </div>
      <!-- postbox area end -->

   </main>

   <!-- Swiper JS -->
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css" />
   <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>
   <script>
      const swiper = new Swiper(".mySwiper", {
         loop: true,
         slidesPerView: 1,
         spaceBetween: 10,
         navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev",
         },
         pagination: {
            el: ".swiper-pagination",
            clickable: true,
         },
      });
   </script>

   <%- include('partials/footer') %>